{% extends 'base.html' %} 
{% load static %} 
{% load markdown_extras %} 

{% block title %} 
  {{ blog.title }} 
{% endblock %} 

{% block link %}
  <script src="{% static 'js/common.js' %}"></script>
  <script src="{% static 'js/popUp.js' %}"></script>
{% endblock %}


{% block content %}
<div
  class="min-h-[calc(100vh-theme(spacing.header))] pb-[100px] bg-my-black-300"
>
  <div
    class="w-full h-full bg-my-black-300 min-h-[calc(100vh-theme(spacing.header))]"
  >
    <article class="grid w-full">

      <div class="h-[500px] sm:h-[450px] col-start-1 row-start-1 grid">
        <img
          src="{% static 'imgs/placeholder.jpg' %}"
          class="w-full object-cover h-[500px] sm:h-[450px] col-start-1 row-start-1"
        />
        <div
          class="w-full bg-my-black-300/70 h-[500px] sm:h-[450px] col-start-1 row-start-1"
        ></div>
      </div>
  
      <!-- Content -->
      <div class="w-full px-5 col-start-1 row-start-1">
        <header class="w-full h-[500px] sm:h-[450px] flex justify-center items-center">
          <div class="w-full flex justify-center items-center">
            <div class="max-w-3xl text-center">

              {% if user_is_admin %}
                <div class="w-[100px] mb-6 px-4 py-5 rounded-3xl bg-zinc-800 flex gap-x-6">
                  <a href="/blogs/edit/{{ blog.id }}" class="flex items-center justify-center text-white">
                    <i class="fa-solid fa-pen-to-square fa-lg"></i>
                  </a>
                  <button 
                    data-blog-id="{{ blog.id }}"
                    data-blog-title="{{ blog.title }}"
                    data-toggle="deleteBlogPopUp" class="flex items-center justify-center text-red-400">
                    <i class="fa-solid fa-trash-can fa-lg"></i>
                  </button>
                </div>
              {% endif %}

              <h1 class="text-4xl sm:text-5xl text-my-white font-semibold">
                {{ blog.title }}
              </h1>
              <p class="mt-5 sm:text-lg text-gray-400">
                {{ blog.description }}
              </p>
              <div
                class="text-sm mt-10 italic text-gray-400 flex items-center justify-center gap-2"
              >
                <div class="w-[50px] h-[50px]">
                  <img
                    src="{% static 'imgs/placeholder.jpg'%}"
                    class="w-full h-full object-cover rounded-full"
                  />
                </div>
                <p>
                  Created by
                  <span
                    class="not-italic text-neon-purple font-semibold underline"
                    >{{ blog.author.first_name }} {{ blog.author.last_name }}
                  </span>
                </p>
                <span class="not-italic">|</span>
                <p>
                  Created on
                  <span class="not-italic text-my-white font-semibold"
                    >{{ blog.date_created|date:"F j, Y" }}.</span>
                </p>
              </div>
            </div>
          </div>
        </header>

        <section class="py-16 w-full flex justify-center">
          <div class="max-w-7xl w-full flex justify-center">
            <div
              class="bg-my-black-300 prose prose-invert max-w-3xl text-my-white text-[17px]"
            >
              {{ blog.content|convert_markdown|safe }}
            </div>
          </div>
        </section>
      </div>
    </article>
  </div>
</div>

{% if user_is_admin %}
<div id="delete-blog-pop-up" class="ancestor-to-hide hidden fixed inset-0 z-[1000] bg-black/50 flex items-center justify-center">
  <div class="w-full max-w-[500px] bg-zinc-800 text-white shadow-lg rounded-md text-center">
    
    <div class="flex flex-col items-center gap-y-6 px-8 pt-6 relative">

        <span class="js-hide-ancestor absolute top-9 right-8 flex items-center justify-center text-xl hover:cursor-pointer">
          <i class="fa-solid fa-xmark fa-xl"></i>
        </span>

      <div class="py-8 px-5 bg-red-300/10 rounded-full relative">
        <span class="flex items-center justify-center text-red-400 text-lg">
          <i class="fa-solid fa-circle-exclamation fa-xl"></i>
        </span>
      </div>
      <div class="flex flex-col gap-y-3">
        <h2 class="text-2xl">You are about to delete a blog</h2>
        <p>Are you sure you want to delete <span id="delete-blog-pop-up-blog-name" class="font-semibold"></span>. This action cannot be undone.</p>
      </div>
    </div>

    <form 
      method="post"
      action="/blogs/delete/"
      class="mt-12 bg-zinc-900 flex gap-5 px-8 py-6">
      {% csrf_token %}
      <button class="js-hide-ancestor py-2 px-5 border border-white w-full rounded-md">Cancel</button>
      <button class="py-2 px-5 w-full rounded-md bg-red-700">Delete</button>
    </form>
  </div>
</div>
{% endif %}

{% endblock %}
